
### 1. 文档摘要

　　给出一个实体类示例作为参考。

### 2. 示例与说明

#### 2.1 示例一

```java
/**
 * Radius 登录帐号                            <===== 这是类的解释部分（文档）
 *
 * @author Jai
 * @since: v1.0
 */
@Entity
@Table(name="Radius_Account")
public class RadiusAccount extends HasCreateTimeEntity{
	
    // 这个是  DAO，可以用来进行类层面的数据操作
	public final static RadiusAccount dao = new RadiusAccount();

	/**
	 * 帐号
	 */
	private String name;
	
	/**
	 * 密码
	 */
	private String password;
	
	/**
	 * true: 可以多个客户端使用。 false：只能一个客户端使用
	 */
	private Boolean multiUser;
	
	/**
	 * 帐号类型
	 */
	@Enumerated(EnumType.STRING)
	private RadiusAccountType accountType;
	
	/**
	 * 使用最大时长，0 表示 Radius 不返回时长控制（对于计费服务而言） 
	 */
	private int sessionTimeout;
	
	/**
	 * 在线最大空闲时间，0 表示 radius 不返回
	 */
	private int idleTimeout;
	
    /**
     * 存放不固定类型和内容的对象数据，例如策略         <=== 使用 JSON 类型会比较灵活
     */
	@JsonField
	@Column(name="attributes", columnDefinition="JSON")
	private JSONObject attributes;

	/**
	 * 使用用户名查找
	 * 
	 * @param userName
	 * @return
	 */
	public RadiusAccount findByUserName(String userName) throws Exception{
		return this.findUniqueBy("name", userName);
	}
	
	/**
	 * 是黑名单人物。如果是返回 true，其他返回 false（包含数据库失败）
	 * 
	 * @param userName
	 * @return
	 */
	public boolean inBlocked(String userName) {
		String where = "(name=? And accountType=?)";
		try{
			List<RadiusAccount> accounts = findWithWhere(where, new Object[]{userName, "Blocked"});
			
			return ListUtils.notEmpty(accounts);
			
		}catch(Exception e){
			RadiusLogger.log.error("[Radius Account]==> 从数据库中读取记录[name=" + userName + "]失败，异常", e);
		}
		return false;
	}
	
	/**
	 * 插入或更新
	 * @param account
	 * @return
	 */
	public BooleanResult insertOrUpdate(RadiusAccount account) {
		try{
			if(account.getId() == null || account.getId() <= 0){			
				RadiusAccount exists = findByUserName(account.getName());
				if(exists != null){
					return BooleanResult.ofError("帐号名称[" + account.getName() + "]已经存在，名称必须唯一，帐号创建失败");
				}
			}
			account.save();
			
			return BooleanResult.SUCCESS;
		}catch(Exception e){
			return BooleanResult.ofException("数据保存到数据库产生异常，帐号存储失败", e);
		}
	}
		
	/**
	 * @return the name
	 */
	public String getName() {
		return name;
	}

	/**
	 * @param name the name to set
	 */
	public void setName(String name) {
		this.name = name;
	}

	/**
	 * @return the password
	 */
	public String getPassword() {
		return password;
	}

	/**
	 * @param password the password to set
	 */
	public void setPassword(String password) {
		this.password = password;
	}

	/**
	 * @return the multiUse
	 */
	public Boolean getMultiUser() {
		return multiUser;
	}

	/**
	 * @param multiUse the multiUse to set
	 */
	public void setMultiUser(Boolean multiUse) {
		this.multiUser = multiUse;
	}

	/**
	 * @return the accountType
	 */
	public RadiusAccountType getAccountType() {
		return accountType;
	}

	/**
	 * @param accountType the accountType to set
	 */
	public void setAccountType(RadiusAccountType accountType) {
		this.accountType = accountType;
	}

	/**
	 * @return the sessionTimeout
	 */
	public int getSessionTimeout() {
		return sessionTimeout;
	}

	/**
	 * @param sessionTimeout the sessionTimeout to set
	 */
	public void setSessionTimeout(int sessionTimeout) {
		this.sessionTimeout = sessionTimeout;
	}

	/**
	 * @return the idleTimeout
	 */
	public int getIdleTimeout() {
		return idleTimeout;
	}

	/**
	 * @param idleTimeout the idleTimeout to set
	 */
	public void setIdleTimeout(int idleTimeout) {
		this.idleTimeout = idleTimeout;
	}

	/**
	 * @return the attributes
	 */
	public JSONObject getAttributes() {
		return attributes;
	}

	/**
	 * @param attributes the attributes to set
	 */
	public void setAttributes(JSONObject attributes) {
		this.attributes = attributes;
	}

	/* (non-Javadoc)
	 * @see java.lang.Object#toString()
	 */
	@Override
	public String toString() {
		StringBuilder builder = new StringBuilder();
		builder.append("RadiusAccount [name=");
		builder.append(name);
		builder.append(", password=");
		builder.append(password);
		builder.append(", multiUse=");
		builder.append(multiUser);
		builder.append(", accountType=");
		builder.append(accountType);
		builder.append(", sessionTimeout=");
		builder.append(sessionTimeout);
		builder.append(", idleTimeout=");
		builder.append(idleTimeout);
		builder.append(", attributes=");
		builder.append(attributes);
		builder.append("]");
		return builder.toString();
	}

}
```

 + **DAO 模式**

    我们看到实体类的第一行，创建了一个静态实体类对象 `dao`：

    **`public final static RadiusAccount dao = new RadiusAccount();`**

    这个`dao`对象是用来进行类层面上的操作。一般情况下，实体数据包括两个层面的操作：

    - 实体对象本身操作：更新、新增、删除和加载自身。（对自身个体的操作）

    - 实体类层面（即非自身）：查找，更新、删除和加载其他实体对象。

    创建全局静态对象`dao`，就是这样使用，下面是一些示例：

```java
/**
 * Web 请求处理，直接使用 DAO 而不是通过 Service 再使用，是因为请求操作比较简单 <br/>
 *
 * @author Jai
 * @since: v1.0
 */
@Controller(path="/radius/account")
public class RadiusAccountAction {

	/**
	 * 首页
	 *
	 * @return
	 */
	@Get("/")
	public ModelAndView index(){
		ModelAndView mView = new ModelAndView("/account/index");
		
		return mView;
	}
	
	/**
	 * 数据查询
	 *
	 * @param bean
	 * @return
	 */
	@Get("/query")
	public @ResponseBody DataResult<DefaultPageBean> query(RadiusAccountQueryBean bean){
		RadiusLogger.log.info("[Get /radius/account/query]==> 查询认证帐号数据，查询值：" + bean);
		
		try{
			DefaultPageBean result = RadiusAccount.dao.queryWithDefaultPageBean(bean);
			return DataResult.ofSuccess(result);
		}catch(Exception e){
			RadiusLogger.log.error("[Get /radius/account/query]==> 查询认证帐号数据失败，查询值：" + bean + "，错误：", e);
			return DataResult.ofException(null, "查询帐号数据失败", e);
		}
	}
	
	/**
	 * 提交数据创建或修改认证帐号
	 *
	 * @return
	 */
	@Post("/")
	public @ResponseBody BooleanResult save(RadiusAccountModifyBean bean){
		RadiusLogger.log.info("[Post /radius/account/]==> 提交创建或修改帐号数据：" + bean);

		return bean.valid()
				   .when(
						   pass->{
							   RadiusAccount account = bean.toAccount();
							   
							   return RadiusAccount.dao.insertOrUpdate(account);
						   },
						   err->{
							   RadiusLogger.log.error("[Post /radius/account/]==> 提交创建或修改帐号失败，数据：" + bean + "，错误：", err);
							   return err;
						   }
					);
	}
	
	/**
	 * 删除帐号
	 *
	 * @param id
	 * @return
	 */
	@Delete("/{id}")
	public @ResponseBody BooleanResult delete(@PathVariable Long id){
		RadiusLogger.log.info("[Del /radius/account/]==> 删除帐号：" + id);
		
		try{
			RadiusAccount.dao.delete(id);
			return BooleanResult.SUCCESS;
		}catch(Exception e){
			RadiusLogger.log.error("[Del /radius/account/]==> 删除 帐号:" + id + " 失败，异常：", e);
			return BooleanResult.ofException("系统出错，帐号删除失败", e);
		}
	}

	/**
	 * 修改属性
	 *
	 * @param id
	 * @param bean
	 * @return
	 */
	@Put("/{id}")
	public @ResponseBody DataResult<RadiusAccount> modify(@PathVariable Long id, RadiusAccountModifyBean bean){
		RadiusLogger.log.info("[Put /radius/account/]==> 修改帐号：" + id + " 的属性：" + bean);
		
		bean.setId(id);
		return RadiusAccount.dao.updateData(bean)
								.when(
									success->{
										try{
											RadiusAccount ra = RadiusAccount.dao.load(id);
											return DataResult.ofSuccess(ra);
										}catch(Exception e){
											RadiusLogger.log.error("[Put /radius/account/]==> 从数据库读取帐号记录:[id=" + id + "]失败，异常：", e);
											return DataResult.ofException(null, "从数据库读取帐号记录失败", e);
										}
									}, 
									err->{
										RadiusLogger.log.error("[Put /radius/account/]==> 修改帐号：" + id + " 的属性：" + bean + " 失败，错误：", err);
										return DataResult.ofErrResult(null, err);
									});
		
	}
}
```

 + **JSON 类型** 应用于是对象数据类型

    对于一些实体类中，存在固定对象或不固定结构的数据情况。通常建议使用`JSON`类型来保存。

#### 2.2 示例二

[待续]

